<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø§Ù„Ø´Ø±Ù‚ÙŠØ© - Ø¨Ø¥Ø´Ø±Ø§Ù Ù…Ø­Ù…Ø¯ Ø¹Ø¯ÙŠ Ù…Ø¤ÙŠØ¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
        body { font-family: 'Tajawal', sans-serif; background-color: #f0f2f5; }
        .hidden { display: none !important; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .channel-post { background: white; border-radius: 15px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-right: 6px solid #1e3a8a; margin-bottom: 15px; }
        .chat-msg { background: #dcf8c6; padding: 10px; border-radius: 10px; margin-bottom: 5px; max-width: 80%; }
    </style>
</head>
<body class="min-h-screen">

    <div id="login-screen" class="max-w-md mx-auto my-10 p-6 bg-white rounded-3xl shadow-xl border-t-8 border-blue-900">
        <h1 class="text-2xl font-bold text-center text-blue-900 mb-2">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</h1>
        <p class="text-[10px] text-center font-bold text-gray-500 mb-6">Ø§Ù„Ù…Ø·ÙˆØ±: Ù…Ø­Ù…Ø¯ Ø¹Ø¯ÙŠ Ù…Ø¤ÙŠØ¯ Ø­Ù…Ø§Ø¯ÙŠ</p>

        <div class="space-y-3">
            <div class="text-center">
                <img id="preview" src="https://via.placeholder.com/80" class="w-20 h-20 rounded-full mx-auto border-2 border-blue-900 object-cover">
                <input type="file" id="uFile" class="hidden" onchange="handleImg(this)">
                <button onclick="document.getElementById('uFile').click()" class="text-[10px] bg-blue-900 text-white px-4 py-1 rounded-full mt-2">Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ø·Ø§Ù„Ø¨/Ø§Ù„Ù…Ø¯Ø±Ø³</button>
            </div>

            <input type="text" id="uName" class="w-full p-3 border rounded-xl text-sm" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ">
            <input type="tel" id="uPhone" class="w-full p-3 border rounded-xl text-sm" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
            
            <select id="uRole" class="w-full p-3 border rounded-xl font-bold text-sm bg-gray-50" onchange="toggleRoleUI()">
                <option value="Ø·Ø§Ù„Ø¨">Ø·Ø§Ù„Ø¨</option>
                <option value="Ù…Ø¯Ø±Ø³">Ù…Ø¯Ø±Ø³</option>
                <option value="Ù…Ø¯ÙŠØ±">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</option>
                <option value="Ù…Ø¹Ø§ÙˆÙ†">Ø§Ù„Ù…Ø¹Ø§ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ</option>
                <option value="ÙˆÙ„ÙŠ Ø§Ù…Ø±">ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø·Ø§Ù„Ø¨</option>
            </select>

            <input type="password" id="uCode" class="hidden w-full p-3 border border-red-300 rounded-xl text-sm" placeholder="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø®Ø§Øµ">

            <div id="edu-selection" class="grid grid-cols-2 gap-2">
                <select id="uGrade" class="p-3 border rounded-xl text-sm font-bold bg-blue-50">
                    <option>Ø§Ù„Ø±Ø§Ø¨Ø¹</option><option>Ø§Ù„Ø®Ø§Ù…Ø³</option><option>Ø§Ù„Ø³Ø§Ø¯Ø³</option>
                </select>
                <select id="uSection" class="p-3 border rounded-xl text-sm font-bold bg-blue-50">
                    <option>Ø£</option><option>Ø¨</option><option>Ø¬</option><option>Ø¯</option><option>Ù‡Ù€</option>
                    <option>Ùˆ</option><option>Ø²</option><option>Ø­</option><option>Ø·</option><option>ÙŠ</option>
                </select>
            </div>

            <div id="teacher-spec" class="hidden border-t pt-2">
                <p class="text-[10px] font-bold text-blue-800">Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØªÙŠ ØªØ¯Ø±Ø³Ù‡Ø§:</p>
                <input type="text" id="uSubject" class="w-full p-3 border rounded-xl text-sm mt-1" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡ ÙˆØ§Ù„ÙÙŠØ²ÙŠØ§Ø¡">
            </div>

            <button onclick="doLogin()" class="w-full bg-blue-900 text-white py-4 rounded-2xl font-bold shadow-lg">Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…Ù†ØµØ©</button>
        </div>
    </div>

    <div id="app" class="hidden flex flex-col h-screen">
        <header class="bg-blue-900 text-white p-4 flex justify-between items-center shadow-lg">
            <div class="flex items-center gap-2">
                <img id="navImg" class="w-10 h-10 rounded-full border border-white">
                <div>
                    <h2 id="navName" class="text-xs font-bold"></h2>
                    <p id="navMeta" class="text-[8px] text-blue-200"></p>
                </div>
            </div>
            <button onclick="location.reload()" class="bg-red-600 px-3 py-1 rounded-full text-[10px]">Ø®Ø±ÙˆØ¬</button>
        </header>

        <main class="flex-grow overflow-y-auto p-4 pb-24">
            
            <section id="admin-view" class="hidden space-y-4">
                <div class="bg-white p-4 rounded-2xl shadow border-2 border-blue-900">
                    <h3 class="font-bold text-sm mb-2">ğŸ“¢ ØªÙˆØµÙŠØ§Øª Ø§Ù„Ù…Ø¯ÙŠØ± ÙˆØ§Ù„Ù…Ø¹Ø§ÙˆÙ†</h3>
                    <textarea id="adminPost" class="w-full p-2 border rounded-lg text-sm" placeholder="Ù†Ø´Ø± Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨..."></textarea>
                    <button onclick="publishAdmin()" class="w-full bg-blue-900 text-white py-2 rounded-lg mt-2 text-xs">Ù†Ø´Ø± Ø§Ù„Ø¢Ù†</button>
                </div>
                <div id="student-list" class="bg-white p-4 rounded-2xl shadow">
                    <h3 class="font-bold text-sm mb-2">ğŸ“Š Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</h3>
                    <div id="list-container" class="space-y-2 text-[10px]">
                        </div>
                </div>
            </section>

            <section id="teacher-view" class="hidden space-y-4">
                <div class="bg-white p-4 rounded-2xl shadow border-2 border-green-600">
                    <h3 class="font-bold text-sm mb-2">ğŸ“‚ Ù‚Ù†Ø§Ø© Ø§Ù„Ù…Ø§Ø¯Ø©: <span id="mySub"></span></h3>
                    <textarea id="teachPost" class="w-full p-2 border rounded-lg text-sm" placeholder="Ù†Ø´Ø± Ø¯Ø±Ø³ØŒ ØµÙˆØ±Ø©ØŒ Ø£Ùˆ Ù…Ù„Ù..."></textarea>
                    <div class="flex gap-2 mt-2">
                        <button class="bg-gray-100 p-2 rounded text-[10px]">ğŸ“· ØµÙˆØ±Ø©</button>
                        <button class="bg-gray-100 p-2 rounded text-[10px]">ğŸ“ Ù…Ù„Ù</button>
                        <button onclick="publishTeacher()" class="flex-grow bg-green-600 text-white py-2 rounded-lg text-xs">Ù†Ø´Ø± ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©</button>
                    </div>
                </div>
            </section>

            <div id="channels-tab" class="tab-content active">
                <h2 class="font-bold text-sm mb-4 text-blue-900">ğŸ“¢ Ø§Ù„Ù‚Ù†ÙˆØ§Øª ÙˆØ§Ù„ØªØ¨Ù„ÙŠØºØ§Øª</h2>
                <div id="feed"></div>
            </div>

            <div id="chat-tab" class="tab-content">
                <h2 class="font-bold text-sm mb-4 text-blue-900">ğŸ’¬ Ø¯Ø±Ø¯Ø´Ø© Ø´Ø¹Ø¨Ø© <span id="chatTitle"></span></h2>
                <div id="chat-box" class="h-64 overflow-y-auto bg-white p-3 rounded-xl mb-3 shadow-inner"></div>
                <div class="flex gap-2">
                    <input type="text" id="chatInp" class="flex-grow p-2 border rounded-xl text-sm" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...">
                    <button onclick="sendMsg()" class="bg-blue-900 text-white px-4 rounded-xl">ğŸš€</button>
                </div>
            </div>
        </main>

        <nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around p-3 shadow-2xl z-50">
            <button onclick="showTab('channels')" class="flex flex-col items-center"><span class="text-xl">ğŸ“¢</span><span class="text-[9px] font-bold">Ø§Ù„Ù‚Ù†ÙˆØ§Øª</span></button>
            <button id="nav-chat" onclick="showTab('chat')" class="flex flex-col items-center"><span class="text-xl">ğŸ’¬</span><span class="text-[9px] font-bold">Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©</span></button>
            <button id="nav-admin" onclick="showTab('admin')" class="hidden flex flex-col items-center"><span class="text-xl">ğŸ“Š</span><span class="text-[9px] font-bold">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</span></button>
        </nav>
    </div>

    <script>
        let me = {};
        const PASSWORDS = { "Ù…Ø¯ÙŠØ±": "m123", "Ù…Ø¹Ø§ÙˆÙ†": "a123", "Ù…Ø¯Ø±Ø³": "t123" };

        function handleImg(input) {
            const reader = new FileReader();
            reader.onload = (e) => { 
                document.getElementById('preview').src = e.target.result;
                me.photo = e.target.result;
            };
            reader.readAsDataURL(input.files[0]);
        }

        function toggleRoleUI() {
            const r = document.getElementById('uRole').value;
            document.getElementById('uCode').classList.toggle('hidden', r === 'Ø·Ø§Ù„Ø¨' || r === 'ÙˆÙ„ÙŠ Ø§Ù…Ø±');
            document.getElementById('teacher-spec').classList.toggle('hidden', r !== 'Ù…Ø¯Ø±Ø³');
        }

        function doLogin() {
            me.name = document.getElementById('uName').value;
            me.role = document.getElementById('uRole').value;
            me.grade = document.getElementById('uGrade').value;
            me.section = document.getElementById('uSection').value;
            me.subject = document.getElementById('uSubject').value;
            const code = document.getElementById('uCode').value;

            if(!me.name || !me.photo) return alert("ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ ÙˆØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©");
            if(PASSWORDS[me.role] && code !== PASSWORDS[me.role]) return alert("Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ Ø®Ø§Ø·Ø¦");

            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            
            document.getElementById('navName').innerText = me.name;
            document.getElementById('navImg').src = me.photo;
            document.getElementById('navMeta').innerText = `${me.role} | ${me.grade} - ${me.section}`;
            document.getElementById('chatTitle').innerText = me.section;

            if(me.role === 'Ù…Ø¯ÙŠØ±' || me.role === 'Ù…Ø¹Ø§ÙˆÙ†') {
                document.getElementById('admin-view').classList.remove('hidden');
                document.getElementById('nav-admin').classList.remove('hidden');
                // Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ± Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© ÙƒÙ…Ø«Ø§Ù„
                addStudentToList(me.name, me.photo, me.role);
            }
            if(me.role === 'Ù…Ø¯Ø±Ø³') {
                document.getElementById('teacher-view').classList.remove('hidden');
                document.getElementById('mySub').innerText = me.subject;
            }
        }

        function showTab(t) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            if(t === 'admin') document.getElementById('admin-view').classList.remove('hidden');
            else document.getElementById(t + '-tab').classList.add('active');
        }

        function publishAdmin() {
            const txt = document.getElementById('adminPost').value;
            if(!txt) return;
            const post = `<div class="channel-post border-red-600"><b class="text-red-600 text-xs">ğŸ“¢ ØªØ¨Ù„ÙŠØº Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</b><p class="text-sm mt-1">${txt}</p></div>`;
            document.getElementById('feed').insertAdjacentHTML('afterbegin', post);
            document.getElementById('adminPost').value = "";
        }

        function publishTeacher() {
            const txt = document.getElementById('teachPost').value;
            if(!txt) return;
            const post = `<div class="channel-post"><b class="text-blue-900 text-xs">ğŸ“š Ù‚Ù†Ø§Ø© Ù…Ø§Ø¯Ø© ${me.subject}</b><p class="text-sm mt-1">${txt}</p><span class="text-[8px] text-gray-400 italic">Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø£Ø³ØªØ§Ø°: ${me.name}</span></div>`;
            document.getElementById('feed').insertAdjacentHTML('afterbegin', post);
            document.getElementById('teachPost').value = "";
        }

        function addStudentToList(name, img, role) {
            const item = `<div class="flex items-center gap-2 p-2 border-b"><img src="${img}" class="w-6 h-6 rounded-full"><span>${name} (${role})</span></div>`;
            document.getElementById('list-container').innerHTML += item;
        }

        function sendMsg() {
            const txt = document.getElementById('chatInp').value;
            if(!txt) return;
            const msg = `<div class="chat-msg"><b>Ø£Ù†Øª:</b><br>${txt}</div>`;
            document.getElementById('chat-box').innerHTML += msg;
            document.getElementById('chatInp').value = "";
        }
    </script>
</body>
</html>
