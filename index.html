<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø§Ù„Ø´Ø±Ù‚ÙŠØ© - Ù…Ø­Ù…Ø¯ Ø¹Ø¯ÙŠ Ù…Ø¤ÙŠØ¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
        body { font-family: 'Tajawal', sans-serif; background: #f1f5f9; }
        .hidden { display: none !important; }
        .app-card { background: white; border-radius: 20px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); padding: 15px; margin-bottom: 15px; }
        .channel-style { background: #e7eff6; border-radius: 15px; padding: 10px; border-right: 5px solid #1e3a8a; }
        .chat-bubble { max-width: 80%; padding: 10px; border-radius: 15px; font-size: 13px; margin: 5px 0; }
    </style>
</head>
<body class="min-h-screen">

    <div id="login-screen" class="max-w-md mx-auto my-10 p-6 bg-white rounded-[2.5rem] shadow-2xl border-t-8 border-blue-900">
        <h1 class="text-2xl font-bold text-center text-blue-900">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</h1>
        <p class="text-[10px] text-center font-bold text-gray-500 mb-6 italic">ØªØ·ÙˆÙŠØ± Ø§Ù„Ø·Ø§Ù„Ø¨: Ù…Ø­Ù…Ø¯ Ø¹Ø¯ÙŠ Ù…Ø¤ÙŠØ¯</p>

        <div class="space-y-3">
            <div class="text-center">
                <img id="previewImg" src="https://via.placeholder.com/80" class="w-20 h-20 rounded-full mx-auto border-2 border-blue-900 object-cover">
                <input type="file" id="userPhoto" class="hidden" onchange="loadPhoto(event)">
                <button onclick="document.getElementById('userPhoto').click()" class="text-[10px] bg-blue-900 text-white px-3 py-1 rounded-full mt-2">ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø©</button>
            </div>

            <input type="text" id="regName" class="w-full p-3 border rounded-xl text-sm" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ">
            <input type="tel" id="regPhone" class="w-full p-3 border rounded-xl text-sm" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
            
            <select id="regRole" class="w-full p-3 border rounded-xl font-bold text-sm bg-gray-50" onchange="updateUI()">
                <option value="Ø·Ø§Ù„Ø¨">Ø·Ø§Ù„Ø¨</option>
                <option value="Ù…Ø¯Ø±Ø³">Ù…Ø¯Ø±Ø³</option>
                <option value="Ù…Ø¯ÙŠØ±">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</option>
                <option value="Ù…Ø¹Ø§ÙˆÙ†">Ø§Ù„Ù…Ø¹Ø§ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ</option>
                <option value="ÙˆÙ„ÙŠ Ø§Ù…Ø±">ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø·Ø§Ù„Ø¨</option>
            </select>

            <input type="password" id="regCode" class="hidden w-full p-3 border border-red-300 rounded-xl text-sm" placeholder="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø®Ø§Øµ">

            <div id="edu-info" class="grid grid-cols-2 gap-2">
                <select id="regGrade" class="p-3 border rounded-xl text-sm font-bold bg-blue-50">
                    <option value="Ø§Ù„Ø±Ø§Ø¨Ø¹">Ø§Ù„Ø±Ø§Ø¨Ø¹</option><option value="Ø§Ù„Ø®Ø§Ù…Ø³">Ø§Ù„Ø®Ø§Ù…Ø³</option><option value="Ø§Ù„Ø³Ø§Ø¯Ø³">Ø§Ù„Ø³Ø§Ø¯Ø³</option>
                </select>
                <select id="regSection" class="p-3 border rounded-xl text-sm font-bold bg-blue-50">
                    <option value="Ø£">Ø£</option><option value="Ø¨">Ø¨</option><option value="Ø¬">Ø¬</option><option value="Ø¯">Ø¯</option><option value="Ù‡Ù€">Ù‡Ù€</option><option value="Ùˆ">Ùˆ</option><option value="Ø²">Ø²</option><option value="Ø­">Ø­</option><option value="Ø·">Ø·</option><option value="ÙŠ">ÙŠ</option>
                </select>
            </div>

            <div id="teacher-fields" class="hidden space-y-2 border-t pt-2">
                <p class="text-[10px] font-bold">Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„ØªÙŠ ØªØ¯Ø±Ø³Ù‡Ø§:</p>
                <select id="regSubject" class="w-full p-3 border rounded-xl text-sm font-bold">
                    <option value="Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡">Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡</option><option value="Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡">Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡</option><option value="Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª">Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª</option><option value="Ø§Ù„Ø£Ø­ÙŠØ§Ø¡">Ø§Ù„Ø£Ø­ÙŠØ§Ø¡</option><option value="Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©">Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option><option value="Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©">Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option><option value="Ø§Ù„Ø­Ø§Ø³ÙˆØ¨">Ø§Ù„Ø­Ø§Ø³ÙˆØ¨</option><option value="Ø§Ù„Ø§Ø³Ù„Ø§Ù…ÙŠØ©">Ø§Ù„Ø§Ø³Ù„Ø§Ù…ÙŠØ©</option>
                </select>
            </div>

            <button onclick="startApp()" class="w-full bg-blue-900 text-white py-4 rounded-2xl font-bold shadow-lg mt-4">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <div id="app" class="hidden flex flex-col h-screen">
        <header class="bg-blue-900 text-white p-4 shadow-xl flex justify-between items-center">
            <div class="flex items-center gap-3">
                <img id="navPhoto" class="w-10 h-10 rounded-full border-2 border-white object-cover">
                <div>
                    <h2 id="navName" class="text-xs font-bold"></h2>
                    <p id="navInfo" class="text-[9px] text-blue-200"></p>
                </div>
            </div>
            <div class="text-center"><p class="text-[10px] font-bold">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</p></div>
            <button onclick="location.reload()" class="bg-red-600 p-1 px-3 rounded-full text-[10px]">Ø®Ø±ÙˆØ¬</button>
        </header>

        <main class="flex-grow overflow-y-auto p-4 pb-28">
            <div id="admin-publish" class="hidden app-card border-dashed border-2 border-blue-900">
                <h3 class="text-xs font-bold mb-2">ğŸ“¢ Ù†Ø´Ø± ØªØ¨Ù„ÙŠØº Ø±Ø³Ù…ÙŠ (Ù…Ø¯ÙŠØ±/Ù…Ø¹Ø§ÙˆÙ†)</h3>
                <textarea id="adminMsg" class="w-full p-3 border rounded-xl text-sm" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ù‡Ù†Ø§..."></textarea>
                <button onclick="postAdmin()" class="w-full bg-blue-900 text-white mt-2 py-2 rounded-xl text-xs">Ù†Ø´Ø± Ù„Ù„Ø¬Ù…ÙŠØ¹</button>
            </div>

            <div id="teacher-publish" class="hidden app-card border-blue-500 border-2">
                <h3 class="text-xs font-bold mb-2">ğŸ“‚ Ù‚Ù†Ø§Ø© Ø§Ù„Ù…Ø¯Ø±Ø³: <span id="subjectName"></span></h3>
                <textarea id="lessonMsg" class="w-full p-3 border rounded-xl text-sm" placeholder="Ù†Ø´Ø± Ø¯Ø±Ø³ØŒ ØµÙˆØ±Ø©ØŒ Ø£Ùˆ Ù…Ù„Ù..."></textarea>
                <div class="flex gap-2 mt-2">
                    <button class="bg-gray-200 px-4 py-2 rounded-xl text-xs">ğŸ“· ØµÙˆØ±Ø©</button>
                    <button class="bg-gray-200 px-4 py-2 rounded-xl text-xs">ğŸ“ Ù…Ù„Ù</button>
                    <button onclick="postLesson()" class="flex-grow bg-blue-600 text-white py-2 rounded-xl text-xs font-bold">Ù†Ø´Ø± ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©</button>
                </div>
            </div>

            <div id="content-area" class="space-y-4">
                <h2 class="text-xs font-bold text-gray-500 border-b pb-1">Ø¢Ø®Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª ÙˆØ§Ù„ØªØ¨Ù„ÙŠØºØ§Øª</h2>
                <div id="feed"></div>
            </div>
        </main>

        <nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around p-3 shadow-2xl">
            <button onclick="showSection('feed')" class="flex flex-col items-center"><span class="text-xl">ğŸ“¢</span><span class="text-[8px] font-bold">Ø§Ù„Ù‚Ù†ÙˆØ§Øª</span></button>
            <button id="btn-chat" onclick="showSection('chat')" class="flex flex-col items-center"><span class="text-xl">ğŸ’¬</span><span class="text-[8px] font-bold">Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©</span></button>
            <button id="btn-stats" onclick="showSection('stats')" class="hidden flex flex-col items-center"><span class="text-xl">ğŸ“Š</span><span class="text-[8px] font-bold">Ø§Ù„Ø·Ù„Ø§Ø¨</span></button>
            <button id="btn-parents" onclick="showSection('parents')" class="hidden flex flex-col items-center"><span class="text-xl">ğŸ“</span><span class="text-[8px] font-bold">Ø§Ù„Ø¯Ø±Ø¬Ø§Øª</span></button>
        </nav>
    </div>

    <script>
        let userData = {};
        const CODES = { "Ù…Ø¯ÙŠØ±": "m123", "Ù…Ø¹Ø§ÙˆÙ†": "a123", "Ù…Ø¯Ø±Ø³": "t123" };

        function loadPhoto(e) {
            const reader = new FileReader();
            reader.onload = () => { document.getElementById('previewImg').src = reader.result; userData.photo = reader.result; };
            reader.readAsDataURL(e.target.files[0]);
        }

        function updateUI() {
            const role = document.getElementById('regRole').value;
            document.getElementById('regCode').classList.toggle('hidden', role === 'Ø·Ø§Ù„Ø¨' || role === 'ÙˆÙ„ÙŠ Ø§Ù…Ø±');
            document.getElementById('teacher-fields').classList.toggle('hidden', role !== 'Ù…Ø¯Ø±Ø³');
        }

        function startApp() {
            userData.name = document.getElementById('regName').value;
            userData.role = document.getElementById('regRole').value;
            userData.grade = document.getElementById('regGrade').value;
            userData.section = document.getElementById('regSection').value;
            const code = document.getElementById('regCode').value;

            if(!userData.name || !userData.photo) return alert("ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ØµÙˆØ±Ø©");
            if(CODES[userData.role] && code !== CODES[userData.role]) return alert("Ø±Ù…Ø² Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø®Ø§Ø·Ø¦");

            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            
            document.getElementById('navName').innerText = userData.name;
            document.getElementById('navPhoto').src = userData.photo;
            document.getElementById('navInfo').innerText = `${userData.role} | ${userData.grade} - ${userData.section}`;

            if(userData.role === 'Ù…Ø¯ÙŠØ±' || userData.role === 'Ù…Ø¹Ø§ÙˆÙ†') {
                document.getElementById('admin-publish').classList.remove('hidden');
                document.getElementById('btn-stats').classList.remove('hidden');
            }
            if(userData.role === 'Ù…Ø¯Ø±Ø³') {
                document.getElementById('teacher-publish').classList.remove('hidden');
                document.getElementById('subjectName').innerText = document.getElementById('regSubject').value;
            }
            if(userData.role === 'ÙˆÙ„ÙŠ Ø§Ù…Ø±') {
                document.getElementById('btn-parents').classList.remove('hidden');
            }
        }

        function postAdmin() {
            const txt = document.getElementById('adminMsg').value;
            if(!txt) return;
            const card = document.createElement('div');
            card.className = "app-card border-r-4 border-red-600";
            card.innerHTML = `<b class="text-[10px] text-red-600">ØªØ¨Ù„ÙŠØº Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Ø§Ù„Ù…Ø¯ÙŠØ±/Ø§Ù„Ù…Ø¹Ø§ÙˆÙ†)</b><p class="text-sm mt-1">${txt}</p>`;
            document.getElementById('feed').prepend(card);
            document.getElementById('adminMsg').value = "";
        }

        function postLesson() {
            const txt = document.getElementById('lessonMsg').value;
            const sub = document.getElementById('regSubject').value;
            if(!txt) return;
            const card = document.createElement('div');
            card.className = "channel-style mb-4";
            card.innerHTML = `<b class="text-[10px] text-blue-900">ğŸ“š Ù…Ø§Ø¯Ø© ${sub} | Ø§Ù„Ø£Ø³ØªØ§Ø° ${userData.name}</b><p class="text-sm mt-1">${txt}</p><span class="text-[8px] text-gray-500">Ù…ÙˆØ¬Ù‡ Ù„Ø·Ù„Ø§Ø¨ Ø´Ø¹Ø¨Ø© ${userData.section}</span>`;
            document.getElementById('feed').prepend(card);
            document.getElementById('lessonMsg').value = "";
        }
    </script>
</body>
</html>
