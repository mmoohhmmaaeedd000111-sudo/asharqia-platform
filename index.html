<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø§Ù„Ø´Ø±Ù‚ÙŠØ© - Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø­Ù…Ø¯ Ø¹Ø¯ÙŠ Ù…Ø¤ÙŠØ¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        body { font-family: 'Tajawal', sans-serif; background: #f4f7f6; overflow-x: hidden; }
        .hidden { display: none !important; }
        .glass-header { background: rgba(30, 58, 138, 0.95); backdrop-filter: blur(10px); }
        .card { background: white; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: 0.3s; }
        .telegram-post { border-right: 5px solid #1e3a8a; background: white; padding: 15px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .chat-bubble { max-width: 80%; padding: 10px; border-radius: 15px; font-size: 13px; margin-bottom: 8px; position: relative; }
        .my-msg { background: #1e3a8a; color: white; margin-right: auto; border-bottom-left-radius: 2px; }
        .other-msg { background: #e5e7eb; color: #1f2937; margin-left: auto; border-bottom-right-radius: 2px; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div id="login-screen" class="flex-grow flex items-center justify-center p-4">
        <div class="card max-w-md w-full p-8 border-t-8 border-blue-900">
            <div class="text-center mb-6">
                <h1 class="text-3xl font-black text-blue-900">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</h1>
                <p class="text-[10px] font-bold text-gray-400 mt-1 uppercase tracking-widest">Ø§Ù„Ù…Ø·ÙˆØ±: Ù…Ø­Ù…Ø¯ Ø¹Ø¯ÙŠ Ù…Ø¤ÙŠØ¯</p>
            </div>

            <div class="space-y-4">
                <div class="text-center">
                    <img id="p-img" src="https://via.placeholder.com/150" class="w-24 h-24 rounded-full mx-auto border-4 border-blue-100 object-cover shadow-lg">
                    <input type="file" id="u-file" class="hidden" onchange="previewImg(event)">
                    <button onclick="document.getElementById('u-file').click()" class="text-[10px] bg-blue-900 text-white px-4 py-1 rounded-full mt-2 font-bold">Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨</button>
                </div>

                <input type="text" id="u-name" class="w-full p-4 bg-gray-50 border rounded-2xl text-sm" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„ÙƒØ§Ù…Ù„">
                <input type="tel" id="u-phone" class="w-full p-4 bg-gray-50 border rounded-2xl text-sm" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                
                <select id="u-role" class="w-full p-4 bg-gray-50 border rounded-2xl font-bold text-sm" onchange="handleRole()">
                    <option value="Ø·Ø§Ù„Ø¨">Ø·Ø§Ù„Ø¨</option>
                    <option value="Ù…Ø¯Ø±Ø³">Ù…Ø¯Ø±Ø³ Ù…Ø§Ø¯Ø©</option>
                    <option value="Ù…Ø¯ÙŠØ±">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</option>
                    <option value="Ù…Ø¹Ø§ÙˆÙ†">Ø§Ù„Ù…Ø¹Ø§ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ</option>
                    <option value="ÙˆÙ„ÙŠ Ø§Ù…Ø±">ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø·Ø§Ù„Ø¨</option>
                </select>

                <input type="password" id="u-pass" class="hidden w-full p-4 border border-red-200 bg-red-50 rounded-2xl text-sm" placeholder="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø®Ø§Øµ">

                <div id="stu-group" class="grid grid-cols-2 gap-2">
                    <select id="u-grade" class="p-4 bg-blue-50 border rounded-2xl text-sm font-bold"><option>Ø§Ù„Ø±Ø§Ø¨Ø¹</option><option>Ø§Ù„Ø®Ø§Ù…Ø³</option><option>Ø§Ù„Ø³Ø§Ø¯Ø³</option></select>
                    <select id="u-sec" class="p-4 bg-blue-50 border rounded-2xl text-sm font-bold">
                        <option>Ø£</option><option>Ø¨</option><option>Ø¬</option><option>Ø¯</option><option>Ù‡Ù€</option>
                        <option>Ùˆ</option><option>Ø²</option><option>Ø­</option><option>Ø·</option><option>ÙŠ</option>
                    </select>
                </div>

                <div id="tea-group" class="hidden space-y-3 border-t pt-4">
                    <input type="text" id="u-sub" class="w-full p-4 border rounded-2xl text-sm" placeholder="Ø§Ù„Ù…Ø§Ø¯Ø© (Ù…Ø«Ø§Ù„: Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡)">
                    <p class="text-[10px] font-bold text-blue-900">Ø­Ø¯Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø¨ Ø§Ù„ØªÙŠ ØªØ¯Ø±Ø³Ù‡Ø§:</p>
                    <div id="sec-checks" class="grid grid-cols-5 gap-2 bg-gray-50 p-3 rounded-xl"></div>
                </div>

                <button onclick="login()" class="w-full bg-blue-900 text-white py-5 rounded-2xl font-black text-lg shadow-xl hover:bg-blue-800 transition-all">Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…Ù†ØµØ©</button>
            </div>
        </div>
    </div>

    <div id="app" class="hidden flex flex-col h-screen overflow-hidden">
        <header class="glass-header text-white p-4 flex justify-between items-center shadow-2xl z-50">
            <div class="flex items-center gap-3">
                <img id="nav-img" class="w-12 h-12 rounded-full border-2 border-white object-cover">
                <div><h2 id="nav-name" class="text-xs font-bold"></h2><p id="nav-info" class="text-[9px] text-blue-200"></p></div>
            </div>
            <button onclick="logout()" class="bg-red-600 px-4 py-2 rounded-xl text-[10px] font-bold shadow-lg">Ø®Ø±ÙˆØ¬</button>
        </header>

        <main class="flex-grow overflow-y-auto p-4 pb-28">
            <div id="pub-box" class="hidden card p-4 mb-6 border-2 border-dashed border-blue-200">
                <textarea id="p-text" class="w-full p-3 bg-gray-50 rounded-xl text-sm outline-none" rows="3" placeholder="Ø§ÙƒØªØ¨ Ù…Ù†Ø´ÙˆØ±Ø§ Ø¬Ø¯ÙŠØ¯Ø§..."></textarea>
                <div class="flex gap-2 mt-2">
                    <button class="bg-gray-100 p-2 rounded-xl text-xs">ğŸ–¼ï¸ ØµÙˆØ±Ø©</button>
                    <button onclick="addPost()" class="flex-grow bg-blue-900 text-white font-bold rounded-xl text-xs">Ù†Ø´Ø± ÙÙŠ Ø§Ù„Ù‚Ù†ÙˆØ§Øª</button>
                </div>
            </div>

            <div id="tab-home" class="tab-content space-y-4"></div>

            <div id="tab-chat" class="tab-content hidden flex flex-col h-full">
                <div id="chat-msgs" class="flex-grow overflow-y-auto space-y-3 p-2"></div>
                <div class="p-3 bg-white rounded-2xl shadow-xl flex gap-2 border">
                    <input type="text" id="c-inp" class="flex-grow text-sm outline-none" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© Ù„Ø´Ø¹Ø¨ØªÙƒ...">
                    <button onclick="sendChat()" class="bg-blue-900 text-white p-3 px-6 rounded-xl">ğŸš€</button>
                </div>
            </div>

            <div id="tab-admin" class="tab-content hidden space-y-3">
                <h3 class="font-black text-blue-900 border-b pb-2">Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„ØµÙˆØ±</h3>
                <div id="students-list" class="space-y-2"></div>
            </div>
        </main>

        <nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around p-4 shadow-2xl z-50">
            <button onclick="showTab('home')" class="flex flex-col items-center"><span class="text-2xl">ğŸ“¢</span><span class="text-[9px] font-bold">Ø§Ù„Ù‚Ù†ÙˆØ§Øª</span></button>
            <button onclick="showTab('chat')" id="n-chat" class="flex flex-col items-center"><span class="text-2xl">ğŸ’¬</span><span class="text-[9px] font-bold">Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø´Ø¹Ø¨Ø©</span></button>
            <button onclick="showTab('admin')" id="n-admin" class="hidden flex flex-col items-center"><span class="text-2xl">ğŸ“Š</span><span class="text-[9px] font-bold">Ø§Ù„Ø·Ù„Ø§Ø¨</span></button>
        </nav>
    </div>

    <script>
        let me = null;
        const PASSWORDS = {"Ù…Ø¯ÙŠØ±":"111", "Ù…Ø¹Ø§ÙˆÙ†":"222", "Ù…Ø¯Ø±Ø³":"333"};
        const sects = ["Ø£","Ø¨","Ø¬","Ø¯","Ù‡Ù€","Ùˆ","Ø²","Ø­","Ø·","ÙŠ"];

        // ØªÙˆÙ„ÙŠØ¯ Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø³
        sects.forEach(s => document.getElementById('sec-checks').innerHTML += `<label class="text-[10px] flex items-center gap-1"><input type="checkbox" value="${s}"> ${s}</label>`);

        window.onload = () => {
            const saved = localStorage.getItem('school_data_2026');
            if(saved) { me = JSON.parse(saved); enter(); }
        };

        function previewImg(e) {
            const r = new FileReader();
            r.onload = () => document.getElementById('p-img').src = r.result;
            r.readAsDataURL(e.target.files[0]);
        }

        function handleRole() {
            const r = document.getElementById('u-role').value;
            document.getElementById('u-pass').classList.toggle('hidden', r === 'Ø·Ø§Ù„Ø¨' || r === 'ÙˆÙ„ÙŠ Ø§Ù…Ø±');
            document.getElementById('tea-group').classList.toggle('hidden', r !== 'Ù…Ø¯Ø±Ø³');
        }

        function login() {
            const role = document.getElementById('u-role').value;
            const name = document.getElementById('u-name').value;
            const pass = document.getElementById('u-pass').value;
            const img = document.getElementById('p-img').src;

            if(!name || img.includes('placeholder')) return alert("Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ØµÙˆØ±Ø© Ù…Ø·Ù„ÙˆØ¨Ø§Ù†!");
            if(PASSWORDS[role] && pass !== PASSWORDS[role]) return alert("Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­!");

            let tSecs = [];
            document.querySelectorAll('#sec-checks input:checked').forEach(c => tSecs.push(c.value));

            me = { name, role, img, grade: document.getElementById('u-grade').value, sec: document.getElementById('u-sec').value, sub: document.getElementById('u-sub').value, tSecs };
            localStorage.setItem('school_data_2026', JSON.stringify(me));
            enter();
        }

        function enter() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            document.getElementById('nav-img').src = me.img;
            document.getElementById('nav-name').innerText = me.name;
            document.getElementById('nav-info').innerText = `${me.role} | ${me.grade}-${me.sec}`;

            if(me.role !== 'Ø·Ø§Ù„Ø¨' && me.role !== 'ÙˆÙ„ÙŠ Ø§Ù…Ø±') document.getElementById('pub-box').classList.remove('hidden');
            if(me.role === 'Ù…Ø¯ÙŠØ±' || me.role === 'Ù…Ø¹Ø§ÙˆÙ†') document.getElementById('n-admin').classList.remove('hidden');
            if(me.role === 'ÙˆÙ„ÙŠ Ø§Ù…Ø±') document.getElementById('n-chat').classList.add('hidden');
        }

        function showTab(t) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
            document.getElementById('tab-'+t).classList.remove('hidden');
            if(t === 'admin') loadStudents();
        }

        function addPost() {
            const txt = document.getElementById('p-text').value; if(!txt) return;
            const html = `<div class="telegram-post">
                <div class="flex items-center gap-2 mb-2">
                    <img src="${me.img}" class="w-6 h-6 rounded-full border">
                    <b class="text-[11px] text-blue-900">${me.role === 'Ù…Ø¯Ø±Ø³' ? 'Ù‚Ù†Ø§Ø© '+me.sub : 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©'}</b>
                </div>
                <p class="text-sm text-gray-800">${txt}</p>
                <span class="text-[8px] text-gray-400 mt-2 block">${me.role === 'Ù…Ø¯Ø±Ø³' ? 'Ù…ÙˆØ¬Ù‡ Ù„Ø´Ø¹Ø¨: '+me.tSecs : 'Ø¹Ø§Ù…'}</span>
            </div>`;
            document.getElementById('tab-home').insertAdjacentHTML('afterbegin', html);
            document.getElementById('p-text').value = "";
        }

        function sendChat() {
            const t = document.getElementById('c-inp').value; if(!t) return;
            const html = `<div class="chat-bubble my-msg">${t}</div>`;
            document.getElementById('chat-msgs').innerHTML += html;
            document.getElementById('c-inp').value = "";
            document.getElementById('chat-msgs').scrollTop = document.getElementById('chat-msgs').scrollHeight;
        }

        function loadStudents() {
            document.getElementById('students-list').innerHTML = `
                <div class="flex items-center gap-3 bg-white p-3 rounded-2xl shadow-sm">
                    <img src="${me.img}" class="w-10 h-10 rounded-full border">
                    <div><p class="text-xs font-bold">${me.name}</p><p class="text-[9px] text-gray-500">${me.role} - ${me.grade}/${me.sec}</p></div>
                </div>`;
        }

        function logout() { localStorage.removeItem('school_data_2026'); location.reload(); }
    </script>
</body>
</html>
