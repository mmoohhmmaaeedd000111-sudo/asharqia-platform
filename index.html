<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø§Ù„Ø´Ø±Ù‚ÙŠØ© - Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø­Ù…Ø¯ Ø¹Ø¯ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        body { font-family: 'Tajawal', sans-serif; background: #f4f7f6; }
        .hidden { display: none !important; }
        .main-card { background: white; border-radius: 2rem; box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        .post-style { background: white; border-right: 5px solid #1e3a8a; border-radius: 15px; padding: 15px; margin-bottom: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .chat-msg { background: #e2e8f0; padding: 10px 15px; border-radius: 15px; margin-bottom: 8px; font-size: 13px; width: fit-content; }
    </style>
</head>
<body class="min-h-screen">

    <div id="login-screen" class="max-w-lg mx-auto my-10 p-4">
        <div class="main-card p-8 border-t-[12px] border-blue-900">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-black text-blue-900">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</h1>
                <p class="text-xs font-bold text-amber-700 mt-1 uppercase">ØªØ·ÙˆÙŠØ± Ø§Ù„Ø·Ø§Ù„Ø¨: Ù…Ø­Ù…Ø¯ Ø¹Ø¯ÙŠ Ù…Ø¤ÙŠØ¯ Ø­Ù…Ø§Ø¯ÙŠ</p>
            </div>

            <div class="space-y-4">
                <div class="text-center relative group">
                    <img id="u-img-view" src="https://via.placeholder.com/150" class="w-28 h-28 rounded-full mx-auto border-4 border-blue-100 object-cover shadow-lg">
                    <input type="file" id="u-file" class="hidden" onchange="uploadPhoto(event)">
                    <button onclick="document.getElementById('u-file').click()" class="bg-blue-900 text-white text-[10px] px-4 py-1 rounded-full mt-2 font-bold">Ø±ÙØ¹ ØµÙˆØ±Ø©</button>
                </div>

                <input type="text" id="u-name" class="w-full p-4 bg-gray-50 border rounded-2xl text-sm" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ">
                <input type="tel" id="u-phone" class="w-full p-4 bg-gray-50 border rounded-2xl text-sm" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                
                <select id="u-role" class="w-full p-4 bg-gray-100 border rounded-2xl font-bold text-sm text-blue-900" onchange="checkRole()">
                    <option value="Ø·Ø§Ù„Ø¨">Ø·Ø§Ù„Ø¨</option>
                    <option value="Ù…Ø¯Ø±Ø³">Ù…Ø¯Ø±Ø³ Ù…Ø§Ø¯Ø©</option>
                    <option value="Ù…Ø¯ÙŠØ±">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</option>
                    <option value="Ù…Ø¹Ø§ÙˆÙ†">Ø§Ù„Ù…Ø¹Ø§ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ</option>
                    <option value="ÙˆÙ„ÙŠ Ø§Ù…Ø±">ÙˆÙ„ÙŠ Ø£Ù…Ø±</option>
                </select>

                <div id="pass-div" class="hidden">
                    <input type="password" id="u-pass" class="w-full p-4 bg-red-50 border-2 border-red-100 rounded-2xl text-sm" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ">
                </div>

                <div id="edu-div" class="grid grid-cols-2 gap-3">
                    <select id="u-grade" class="p-4 bg-blue-50 border rounded-2xl text-sm font-bold"><option>Ø§Ù„Ø±Ø§Ø¨Ø¹</option><option>Ø§Ù„Ø®Ø§Ù…Ø³</option><option>Ø§Ù„Ø³Ø§Ø¯Ø³</option></select>
                    <select id="u-sec" class="p-4 bg-blue-50 border rounded-2xl text-sm font-bold">
                        <option>Ø£</option><option>Ø¨</option><option>Ø¬</option><option>Ø¯</option><option>Ù‡Ù€</option>
                        <option>Ùˆ</option><option>Ø²</option><option>Ø­</option><option>Ø·</option><option>ÙŠ</option>
                    </select>
                </div>

                <div id="teacher-div" class="hidden space-y-3 border-t pt-4">
                    <input type="text" id="u-subject" class="w-full p-4 bg-green-50 border rounded-2xl text-sm" placeholder="Ø§Ù„Ù…Ø§Ø¯Ø© (Ù…Ø«Ù„Ø§Ù‹: ÙƒÙŠÙ…ÙŠØ§Ø¡)">
                    <p class="text-[10px] font-bold text-blue-900">Ø§Ø®ØªØ± Ø§Ù„Ø´Ø¹Ø¨ Ø§Ù„ØªÙŠ ØªØ¯Ø±Ø³Ù‡Ø§ (ÙŠÙ…ÙƒÙ† Ø§Ø®ØªÙŠØ§Ø± Ø£ÙƒØ«Ø± Ù…Ù† ÙˆØ§Ø­Ø¯Ø©):</p>
                    <div id="sects-list" class="grid grid-cols-5 gap-2 bg-white p-3 rounded-xl border"></div>
                </div>

                <button onclick="startApp()" class="w-full bg-blue-900 text-white py-5 rounded-3xl font-black text-xl shadow-xl hover:scale-[1.02] transition-all">Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…Ù†ØµØ©</button>
            </div>
        </div>
    </div>

    <div id="app" class="hidden flex flex-col h-screen overflow-hidden">
        <header class="bg-blue-900 text-white p-5 flex justify-between items-center shadow-2xl">
            <div class="flex items-center gap-3">
                <img id="nav-img" class="w-12 h-12 rounded-full border-2 border-amber-400 object-cover">
                <div>
                    <h2 id="nav-name" class="text-sm font-black"></h2>
                    <p id="nav-meta" class="text-[9px] text-blue-200 font-bold uppercase"></p>
                </div>
            </div>
            <button onclick="logout()" class="bg-red-600 px-4 py-1 rounded-full text-[10px] font-bold">Ø®Ø±ÙˆØ¬</button>
        </header>

        <main id="main-content" class="flex-grow overflow-y-auto p-4 pb-24">
            <div id="post-box" class="hidden bg-white p-5 rounded-3xl shadow-md mb-6 border-2 border-blue-50">
                <textarea id="p-text" class="w-full p-3 bg-gray-50 rounded-2xl text-sm outline-none" rows="3" placeholder="Ø§ÙƒØªØ¨ Ø¯Ø±Ø³Ø§Ù‹ Ø£Ùˆ Ù…Ù„ÙØ§Ù‹ Ø£Ùˆ ØªØ¨Ù„ÙŠØºØ§Ù‹..."></textarea>
                <div class="flex gap-2 mt-2">
                    <button class="bg-gray-100 p-2 rounded-xl text-[10px] flex-1">ğŸ“· ØµÙˆØ±Ø©</button>
                    <button class="bg-gray-100 p-2 rounded-xl text-[10px] flex-1">ğŸ“ Ù…Ù„Ù</button>
                    <button onclick="addPost()" class="bg-blue-900 text-white p-2 rounded-xl flex-[2] font-bold text-xs">Ù†Ø´Ø± ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©</button>
                </div>
            </div>

            <div id="feed" class="space-y-4"></div>

            <div id="chat-section" class="hidden space-y-4 h-full flex flex-col">
                <div class="bg-blue-100 p-2 rounded-xl text-center text-[10px] font-bold text-blue-900">Ø¯Ø±Ø¯Ø´Ø© Ø´Ø¹Ø¨Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ (${user.sec})</div>
                <div id="chat-msgs" class="flex-grow overflow-y-auto"></div>
                <div class="flex gap-2 bg-white p-2 rounded-full shadow-lg">
                    <input type="text" id="chat-input" class="flex-grow p-2 outline-none text-sm" placeholder="Ø§Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ ØµÙˆØ±Ø© Ù„Ø´Ø¹Ø¨ØªÙƒ...">
                    <button onclick="sendMsg()" class="bg-blue-900 text-white px-6 rounded-full font-bold">Ø¥Ø±Ø³Ø§Ù„</button>
                </div>
            </div>
        </main>

        <nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around p-4 shadow-[0_-5px_15px_rgba(0,0,0,0.05)]">
            <button onclick="view('feed')" class="flex flex-col items-center gap-1 text-blue-900"><span class="text-2xl">ğŸ“¢</span><span class="text-[10px] font-bold">Ø§Ù„Ù‚Ù†ÙˆØ§Øª</span></button>
            <button onclick="view('chat')" id="chat-btn" class="flex flex-col items-center gap-1 text-gray-400"><span class="text-2xl">ğŸ’¬</span><span class="text-[10px] font-bold">Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©</span></button>
            <button onclick="view('admin')" id="admin-btn" class="hidden flex flex-col items-center gap-1 text-gray-400"><span class="text-2xl">ğŸ“Š</span><span class="text-[10px] font-bold">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</span></button>
        </nav>
    </div>

    <script>
        let user = null;
        const PASSWORDS = {"Ù…Ø¯ÙŠØ±":"1010", "Ù…Ø¹Ø§ÙˆÙ†":"2020", "Ù…Ø¯Ø±Ø³":"333"};
        const SECTS = ["Ø£","Ø¨","Ø¬","Ø¯","Ù‡Ù€","Ùˆ","Ø²","Ø­","Ø·","ÙŠ"];

        // Ù…Ù„Ø¡ Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ø´Ø¹Ø¨ Ù„Ù„Ù…Ø¯Ø±Ø³ (Ø§Ù„Ù…Ø·Ù„Ø¨ 9)
        SECTS.forEach(s => {
            document.getElementById('sects-list').innerHTML += `<label class="text-[10px] flex items-center gap-1 font-bold"><input type="checkbox" name="tSects" value="${s}"> ${s}</label>`;
        });

        window.onload = () => {
            const saved = localStorage.getItem('asharqia_pro');
            if(saved) { user = JSON.parse(saved); openDashboard(); }
        }

        function uploadPhoto(e) {
            const r = new FileReader();
            r.onload = () => document.getElementById('u-img-view').src = r.result;
            r.readAsDataURL(e.target.files[0]);
        }

        function checkRole() {
            const r = document.getElementById('u-role').value;
            document.getElementById('pass-div').classList.toggle('hidden', r === 'Ø·Ø§Ù„Ø¨' || r === 'ÙˆÙ„ÙŠ Ø§Ù…Ø±');
            document.getElementById('teacher-div').classList.toggle('hidden', r !== 'Ù…Ø¯Ø±Ø³');
        }

        function startApp() {
            const role = document.getElementById('u-role').value;
            const pass = document.getElementById('u-pass').value;
            const name = document.getElementById('u-name').value;
            const img = document.getElementById('u-img-view').src;

            if(!name || img.includes('placeholder')) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØµÙˆØ±Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©");
            if(PASSWORDS[role] && pass !== PASSWORDS[role]) return alert("Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­!");

            let tSects = [];
            document.querySelectorAll('input[name="tSects"]:checked').forEach(c => tSects.push(c.value));

            user = { name, role, img, grade: document.getElementById('u-grade').value, sec: document.getElementById('u-sec').value, subject: document.getElementById('u-subject').value, tSects };
            localStorage.setItem('asharqia_pro', JSON.stringify(user));
            openDashboard();
        }

        function openDashboard() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            document.getElementById('nav-img').src = user.img;
            document.getElementById('nav-name').innerText = user.name;
            document.getElementById('nav-meta').innerText = `${user.role} | ${user.grade} - ${user.sec}`;

            if(user.role !== 'Ø·Ø§Ù„Ø¨' && user.role !== 'ÙˆÙ„ÙŠ Ø§Ù…Ø±') document.getElementById('post-box').classList.remove('hidden');
            if(user.role === 'Ù…Ø¯ÙŠØ±' || user.role === 'Ù…Ø¹Ø§ÙˆÙ†') document.getElementById('admin-btn').classList.remove('hidden');
            if(user.role === 'ÙˆÙ„ÙŠ Ø§Ù…Ø±') document.getElementById('chat-btn').classList.add('hidden');
        }

        function view(type) {
            document.getElementById('feed').classList.toggle('hidden', type !== 'feed');
            document.getElementById('chat-section').classList.toggle('hidden', type !== 'chat');
        }

        function addPost() {
            const txt = document.getElementById('p-text').value; if(!txt) return;
            const html = `<div class="post-style">
                <b class="text-xs text-blue-900">${user.role === 'Ù…Ø¯Ø±Ø³' ? 'Ù‚Ù†Ø§Ø© '+user.subject : 'ØªØ¨Ù„ÙŠØº Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©'}</b>
                <p class="text-sm mt-1 text-gray-700 leading-relaxed">${txt}</p>
                <div class="mt-3 flex justify-between text-[8px] font-bold text-gray-400">
                    <span>Ø¨ÙˆØ§Ø³Ø·Ø©: ${user.name}</span>
                    <span>Ù…ÙˆØ¬Ù‡ Ù„Ø´Ø¹Ø¨: ${user.role === 'Ù…Ø¯Ø±Ø³' ? user.tSects.join(', ') : 'Ø§Ù„ÙƒÙ„'}</span>
                </div>
            </div>`;
            document.getElementById('feed').insertAdjacentHTML('afterbegin', html);
            document.getElementById('p-text').value = "";
        }

        function sendMsg() {
            const val = document.getElementById('chat-input').value; if(!val) return;
            document.getElementById('chat-msgs').innerHTML += `<div class="chat-msg"><b>Ø£Ù†Øª:</b> ${val}</div>`;
            document.getElementById('chat-input').value = "";
        }

        function logout() { localStorage.removeItem('asharqia_pro'); location.reload(); }
    </script>
</body>
</html>
