<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø§Ù„Ø´Ø±Ù‚ÙŠØ© - Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø­Ù…Ø¯ Ø¹Ø¯ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        body { font-family: 'Tajawal', sans-serif; background-color: #f8fafc; color: #1e293b; }
        .hidden { display: none !important; }
        .glass-card { background: rgba(255, 255, 255, 0.95); border-radius: 2rem; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .telegram-post { background: white; border-radius: 1.25rem; padding: 1.25rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); border-right: 6px solid #1e3a8a; }
        .chat-bubble { max-width: 85%; padding: 12px; border-radius: 18px; font-size: 14px; margin-bottom: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    </style>
</head>
<body class="min-h-screen">

    <div id="login-screen" class="max-w-md mx-auto my-10 p-4">
        <div class="glass-card p-8 border-t-[12px] border-blue-900">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-black text-blue-900">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</h1>
                <p class="text-[11px] font-bold text-amber-700 mt-2 tracking-widest uppercase">Ø¨Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ù…Ø·ÙˆØ±: Ù…Ø­Ù…Ø¯ Ø¹Ø¯ÙŠ Ù…Ø¤ÙŠØ¯</p>
            </div>

            <div class="space-y-4">
                <div class="relative w-28 h-28 mx-auto group">
                    <img id="previewImg" src="https://via.placeholder.com/150" class="w-full h-full rounded-full border-4 border-blue-100 object-cover shadow-xl">
                    <label class="absolute bottom-0 right-0 bg-blue-900 text-white p-2 rounded-full cursor-pointer hover:scale-110 transition">
                        ğŸ“· <input type="file" id="userPhoto" class="hidden" onchange="handleImage(event)">
                    </label>
                </div>

                <input type="text" id="uName" class="w-full p-4 bg-gray-50 border-2 border-transparent focus:border-blue-900 rounded-2xl outline-none transition" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„ÙƒØ§Ù…Ù„">
                <input type="tel" id="uPhone" class="w-full p-4 bg-gray-50 border-2 border-transparent focus:border-blue-900 rounded-2xl outline-none transition" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                
                <select id="uRole" class="w-full p-4 bg-gray-100 border-none rounded-2xl font-bold text-blue-900" onchange="toggleRoleUI()">
                    <option value="Ø·Ø§Ù„Ø¨">ğŸ“ Ø·Ø§Ù„Ø¨</option>
                    <option value="Ù…Ø¯Ø±Ø³">ğŸ‘¨â€ğŸ« Ù…Ø¯Ø±Ø³ Ù…Ø§Ø¯Ø©</option>
                    <option value="Ù…Ø¯ÙŠØ±">ğŸ›ï¸ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</option>
                    <option value="Ù…Ø¹Ø§ÙˆÙ†">ğŸ“‹ Ø§Ù„Ù…Ø¹Ø§ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ</option>
                    <option value="ÙˆÙ„ÙŠ Ø§Ù…Ø±">ğŸ‘ª ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø·Ø§Ù„Ø¨</option>
                </select>

                <div id="passWrapper" class="hidden">
                    <input type="password" id="uPass" class="w-full p-4 bg-red-50 border-2 border-red-200 rounded-2xl outline-none" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø®Ø§Øµ Ø¨Ø±ØªØ¨ØªÙƒ">
                </div>

                <div id="eduWrapper" class="grid grid-cols-2 gap-3">
                    <select id="uGrade" class="p-4 bg-blue-50 rounded-2xl font-bold"><option>Ø§Ù„Ø±Ø§Ø¨Ø¹</option><option>Ø§Ù„Ø®Ø§Ù…Ø³</option><option>Ø§Ù„Ø³Ø§Ø¯Ø³</option></select>
                    <select id="uSection" class="p-4 bg-blue-50 rounded-2xl font-bold">
                        <option>Ø£</option><option>Ø¨</option><option>Ø¬</option><option>Ø¯</option><option>Ù‡Ù€</option>
                        <option>Ùˆ</option><option>Ø²</option><option>Ø­</option><option>Ø·</option><option>ÙŠ</option>
                    </select>
                </div>

                <div id="teacherWrapper" class="hidden space-y-3 border-t pt-4">
                    <input type="text" id="uSubject" class="w-full p-4 bg-green-50 rounded-2xl" placeholder="Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©">
                    <p class="text-[10px] font-bold text-gray-500 mr-2">Ø­Ø¯Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø¨ Ø§Ù„ØªÙŠ ØªØ¯Ø±Ø³Ù‡Ø§:</p>
                    <div id="multiSections" class="grid grid-cols-5 gap-2 p-2 bg-white rounded-xl"></div>
                </div>

                <button onclick="attemptLogin()" class="w-full bg-blue-900 text-white py-5 rounded-[2rem] font-black text-xl shadow-2xl hover:bg-blue-800 active:scale-95 transition-all mt-6">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù†ØµØ©</button>
            </div>
        </div>
    </div>

    <div id="app" class="hidden flex flex-col h-screen">
        <header class="bg-blue-900 text-white p-5 flex justify-between items-center shadow-xl z-50">
            <div class="flex items-center gap-3">
                <img id="navImg" class="w-12 h-12 rounded-full border-2 border-amber-400 object-cover">
                <div>
                    <h2 id="navName" class="text-sm font-black"></h2>
                    <p id="navMeta" class="text-[9px] text-blue-200 font-bold uppercase"></p>
                </div>
            </div>
            <button onclick="logout()" class="bg-red-500/20 hover:bg-red-600 px-4 py-2 rounded-full text-[10px] font-bold border border-red-500/50">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </header>

        <main class="flex-grow overflow-y-auto p-4 pb-32">
            <div id="publishPanel" class="hidden bg-white p-5 rounded-[2rem] shadow-lg mb-6 border-2 border-blue-100">
                <textarea id="postContent" class="w-full p-4 bg-gray-50 rounded-2xl text-sm outline-none border-none" rows="3" placeholder="Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ø£Ù† ØªÙ†Ø´Ø± Ù„Ø·Ù„Ø§Ø¨ÙƒØŸ"></textarea>
                <div class="flex gap-2 mt-4">
                    <button class="bg-gray-100 p-3 rounded-2xl flex-1 text-xs font-bold">ğŸ“· ØµÙˆØ±Ø©</button>
                    <button class="bg-gray-100 p-3 rounded-2xl flex-1 text-xs font-bold">ğŸ“ Ù…Ù„Ù</button>
                    <button onclick="createPost()" class="bg-blue-900 text-white p-3 rounded-2xl flex-[2] font-black text-xs shadow-lg">Ù†Ø´Ø± ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©</button>
                </div>
            </div>

            <div id="view-home" class="tab-content active space-y-4"></div>
            <div id="view-chat" class="tab-content h-full flex flex-col">
                <div id="chatBox" class="flex-grow overflow-y-auto space-y-3 p-2 bg-white/50 rounded-3xl mb-4"></div>
                <div class="flex gap-2 bg-white p-2 rounded-full shadow-xl">
                    <button class="p-3">ğŸ“·</button>
                    <input type="text" id="chatInput" class="flex-grow outline-none text-sm" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© Ù„Ø´Ø¹Ø¨ØªÙƒ...">
                    <button onclick="sendMessage()" class="bg-blue-900 text-white px-6 rounded-full font-bold">Ø¥Ø±Ø³Ø§Ù„</button>
                </div>
            </div>
            <div id="view-admin" class="tab-content space-y-4">
                <h3 class="font-black text-blue-900 border-b-2 border-blue-900 inline-block pb-1">Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</h3>
                <div id="adminList" class="grid grid-cols-1 gap-2"></div>
            </div>
        </main>

        <nav class="fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-md border-t flex justify-around p-4 shadow-[0_-10px_20px_rgba(0,0,0,0.05)] z-50">
            <button onclick="switchTab('home')" class="flex flex-col items-center gap-1 text-blue-900"><span class="text-2xl">ğŸ“¢</span><span class="text-[10px] font-black">Ø§Ù„Ù‚Ù†ÙˆØ§Øª</span></button>
            <button onclick="switchTab('chat')" id="navChat" class="flex flex-col items-center gap-1 text-gray-400"><span class="text-2xl">ğŸ’¬</span><span class="text-[10px] font-black">Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©</span></button>
            <button onclick="switchTab('admin')" id="navAdmin" class="hidden flex flex-col items-center gap-1 text-gray-400"><span class="text-2xl">ğŸ“Š</span><span class="text-[10px] font-black">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</span></button>
        </nav>
    </div>

    <script>
        let me = null;
        const KEY = 'shrqia_final_v1';
        const RULES = {"Ù…Ø¯ÙŠØ±": "1010", "Ù…Ø¹Ø§ÙˆÙ†": "2020", "Ù…Ø¯Ø±Ø³": "3030"};
        const SECTS = ["Ø£", "Ø¨", "Ø¬", "Ø¯", "Ù‡Ù€", "Ùˆ", "Ø²", "Ø­", "Ø·", "ÙŠ"];

        // Ù…Ù„Ø¡ Ø§Ù„Ø´Ø¹Ø¨ Ù„Ù„Ù…Ø¯Ø±Ø³
        const multiSec = document.getElementById('multiSections');
        SECTS.forEach(s => {
            multiSec.innerHTML += `<label class="flex items-center gap-1 text-[10px] font-bold cursor-pointer"><input type="checkbox" name="tSects" value="${s}" class="w-3 h-3"> ${s}</label>`;
        });

        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¬Ù„Ø³Ø© (Ø§Ù„Ù…Ø·Ù„Ø¨ Ø±Ù‚Ù… 7)
        window.onload = () => {
            const saved = localStorage.getItem(KEY);
            if (saved) { me = JSON.parse(saved); renderApp(); }
        };

        function handleImage(e) {
            const reader = new FileReader();
            reader.onload = () => document.getElementById('previewImg').src = reader.result;
            reader.readAsDataURL(e.target.files[0]);
        }

        function toggleRoleUI() {
            const r = document.getElementById('uRole').value;
            document.getElementById('passWrapper').classList.toggle('hidden', r === 'Ø·Ø§Ù„Ø¨' || r === 'ÙˆÙ„ÙŠ Ø§Ù…Ø±');
            document.getElementById('teacherWrapper').classList.toggle('hidden', r !== 'Ù…Ø¯Ø±Ø³');
        }

        function attemptLogin() {
            const name = document.getElementById('uName').value;
            const role = document.getElementById('uRole').value;
            const pass = document.getElementById('uPass').value;
            const img = document.getElementById('previewImg').src;

            if (!name || img.includes('placeholder')) return alert("Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© Ù…ØªØ·Ù„Ø¨Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ©!");
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ (Ø§Ù„Ù…Ø·Ù„Ø¨ Ø±Ù‚Ù… 2ØŒ 3ØŒ 4)
            if (RULES[role] && pass !== RULES[role]) return alert("Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø±ØªØ¨Ø©!");

            let chosenSects = [];
            document.querySelectorAll('input[name="tSects"]:checked').forEach(c => chosenSects.push(c.value));

            me = {
                name, role, img,
                grade: document.getElementById('uGrade').value,
                section: document.getElementById('uSection').value,
                subject: document.getElementById('uSubject').value,
                mySects: chosenSects
            };

            localStorage.setItem(KEY, JSON.stringify(me));
            renderApp();
        }

        function renderApp() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            document.getElementById('navImg').src = me.img;
            document.getElementById('navName').innerText = me.name;
            document.getElementById('navMeta').innerText = `${me.role} | ${me.grade} - ${me.section}`;

            // ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù†Ø´Ø±
            if (me.role !== 'Ø·Ø§Ù„Ø¨' && me.role !== 'ÙˆÙ„ÙŠ Ø§Ù…Ø±') {
                document.getElementById('publishPanel').classList.remove('hidden');
            }
            if (me.role === 'Ù…Ø¯ÙŠØ±' || me.role === 'Ù…Ø¹Ø§ÙˆÙ†') {
                document.getElementById('navAdmin').classList.remove('hidden');
            }
            if (me.role === 'ÙˆÙ„ÙŠ Ø§Ù…Ø±') {
                document.getElementById('navChat').classList.add('hidden');
            }
        }

        function switchTab(t) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById('view-' + t).classList.add('active');
            if (t === 'admin') loadAdminStats();
        }

        function createPost() {
            const content = document.getElementById('postContent').value;
            if (!content) return;

            const postHTML = `
                <div class="telegram-post">
                    <div class="flex items-center gap-2 mb-3">
                        <img src="${me.img}" class="w-7 h-7 rounded-full border border-blue-200">
                        <b class="text-[11px] text-blue-900">${me.role === 'Ù…Ø¯Ø±Ø³' ? 'Ù‚Ù†Ø§Ø© Ø§Ù„Ù…Ø§Ø¯Ø©: ' + me.subject : 'ØªØ¨Ù„ÙŠØº Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©'}</b>
                    </div>
                    <p class="text-sm text-gray-700 leading-relaxed">${content}</p>
                    <div class="mt-3 pt-2 border-t border-gray-50 flex justify-between items-center text-[8px] font-bold text-gray-400 italic">
                        <span>Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø£Ø³ØªØ§Ø°: ${me.name}</span>
                        <span>Ø´Ø¹Ø¨: ${me.role === 'Ù…Ø¯Ø±Ø³' ? me.mySects : 'Ø§Ù„ÙƒÙ„'}</span>
                    </div>
                </div>`;
            
            document.getElementById('view-home').insertAdjacentHTML('afterbegin', postHTML);
            document.getElementById('postContent').value = "";
        }

        function sendMessage() {
            const txt = document.getElementById('chatInput').value;
            if(!txt) return;
            const msg = `<div class="chat-bubble bg-blue-900 text-white mr-auto rounded-br-none">${txt}</div>`;
            document.getElementById('chatBox').innerHTML += msg;
            document.getElementById('chatInput').value = "";
            document.getElementById('chatBox').scrollTop = document.getElementById('chatBox').scrollHeight;
        }

        function loadAdminStats() {
            document.getElementById('adminList').innerHTML = `
                <div class="bg-white p-4 rounded-2xl flex items-center justify-between shadow-sm border border-gray-100">
                    <div class="flex items-center gap-3">
                        <img src="${me.img}" class="w-10 h-10 rounded-full object-cover">
                        <div>
                            <p class="text-xs font-black">${me.name}</p>
                            <p class="text-[9px] text-gray-400 font-bold uppercase">${me.role} - Ø´Ø¹Ø¨Ø© ${me.section}</p>
                        </div>
                    </div>
                    <span class="bg-green-100 text-green-700 text-[8px] px-2 py-1 rounded-full font-bold">Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†</span>
                </div>`;
        }

        function logout() { localStorage.removeItem(KEY); location.reload(); }
    </script>
</body>
</html>
